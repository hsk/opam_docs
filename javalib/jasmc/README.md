# jasmc

fast jasmin compiler

jasmcはOCamlで書いた、javaのバイトコードアセンブラjasminの高速なコンパイラです。

現状はとりあえず、動かしてみるバージョンです。

## History



- [x] フェーズ 1 パーサのコンパイルを通す

    - [x] パーサをocamlyaccに移植する

まずは、jasminのソースを拾って来て、parser.cupをparser.mlyに、字句解析の処理をlexer.mllに移植しました。
とにかく、コンパイル通ればOKです。というレベルで、mainファイルも作ってません。
とりあえず、パースの値は全て""を返すだけにしておき、アクションを消し、トークンを定義して、文法だけ残してあとは消すだけです。
量が多いので大変ですが、量が多いだけです。

- [x] フェーズ 2 テストコードのパースを通す
	- [x] メイン関数の作成
    - [x] パーサの修正
    - [x] レキサの修正

メイン関数を作成し、レキサを作ってテストコードのパースを通す事を目指しました。
主に、レキサの修正が面倒でした。
テストにはjasminのexamplesを使いました。

- [x] フェーズ 3 クラスを出力する
    - [x] ダミークラスの生成

パースは通っても、処理は何もしないので、javalibを使って出力するコード、パーサのトップに埋め込み、
トップから、より細かい処理へ移動させて行けば、徐々に完成に近づいて行く事を確認し、classファイルを出力して、jasminを出力するコードをメイン関数に追加しました。
とりあえず動けば良いんです。

## TODO

- [x] フェーズ 4 HelloWebのクラスを生成
    - [x] クラスを出力
    - [x] フィールドを出力
    - [ ] メソッドを出力
    - [ ] バイトコードの出力

このフェーズでは1個のファイルを正しくパースしてclassファイルを作成します。
javalibとの格闘です。
まずは、classファイルの大まかなアクセス属性等を出力し、フィールドを処理し、メソッド出力のヘッダ部分を出力し、
最後に、バイトコードの出力を作成します。

ここでどうも、JavaLibには低レベルな表現があるようで、そちらを使った方が楽みたいなのです。

- [x] フェーズ 5 テストコードを通す
    - [ ] Count.j
    - [ ] Switch.j

1個で来たので、より多くのファイルで試して行けばより一般的に動くようになるはずです。
